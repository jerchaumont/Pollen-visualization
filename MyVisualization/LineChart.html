<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pollen line chart</title>
</head>
<body>
  <h1>Concentration pollinique au Luxembourg, 1992-2018</h1>
  <!-- Load d3.js ATTENTION : VERSION v.4 (ne fonctionne pas avec v.7 ?!)-->
  <script src="https://cdn.jsdelivr.net/npm/d3@7.4.4/dist/d3.min.js"></script>
  <script>
    
    // set the dimensions and margins of the graph
    const margin = {top: 10, right: 30, bottom: 30, left: 60},
    width = innerWidth - margin.left - margin.right,
    height = 600 - margin.top - margin.bottom;
    
    // append the svg object to the body of the page
    const svg = d3.select("body")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform",
    "translate(" + margin.left + "," + margin.top + ")");
    
    //Read the data
    d3.csv("pollen_tri.csv",
    
    // Formater les variables:
    function(d){
      return { Date : d3.timeParse("%Y-%m-%d")(d.Date), Ambrosia : +d.Ambrosia }
    }).then(data => {
      
      // Ajout axe X --> it is a date format
      const x = d3.scaleTime()
      .domain(d3.extent(data, function(d) { return d.Date; }))
      .range([ 0, width ]);
      
      // le ticks détermine en combien de parts est divisé l'axe
      const monAxeX = d3.axisBottom(x).ticks(26)
      
      //ajouter axe au svg
      svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call((monAxeX));
      
      // Ajouter axe y
      const y = d3.scaleLinear()
      .domain([0, d3.max(data, function(d) { return +d.Ambrosia; })])
      .range([ height, 0 ]);
      svg.append("g")
      .call(d3.axisLeft(y));
      
      // Ajouter lines charts
      svg.append("path")
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", "steelblue")
      .attr("stroke-width", 1.5)
      .attr("d", d3.line()
      .x(function(d) { return x(d.Date) })
      .y(function(d) { return y(d.Ambrosia) })
      )
    })
    
    // Légende axe X :
    svg.append("text")
    .attr("text-anchor", "end")
    .attr("x", width)
    .attr("y", height + margin.top + 20)
    .text("Période");
    
    // Légende axe Y :
    svg.append("text")
    .attr("text-anchor", "end")
    .attr("transform", "rotate(-90)")
    .attr("y", -margin.left+20)
    .attr("x", -margin.top)
    .text("Concentration pollinique")
    
    
  </script>
</body>
</html>

